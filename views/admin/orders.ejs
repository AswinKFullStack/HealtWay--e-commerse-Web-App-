<%- include("../../views/partials/admin/header") %>

<link rel="stylesheet" href="/css/adminCss/customers.css">

<h2 class="my-4">Order Management</h2>

<!-- Search bar for products -->
<div class="form-group mb-4">
    <input type="text" class="form-control" id="searchOrder" placeholder="Search products" value="<%= searchTerm %>">
</div>

<!-- Product Table -->
<table class="table table-striped">
    <thead>
        <tr>
            <th>Order ID</th>
            <th>User Name</th>
            <th>No of Items</th>
            <th>Delivery Address</th>
            <th>Total Price</th>
            <th>Created Date</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        <% oders.forEach(function(order) { %>        
            <tr>
                <td><%= order._id %></td>
                <td><%= order.user.name%></td>
                <td><%= order.items.length %></td>
                <td><%= order.address.address %></td>
                <td><%= order.totalPrice %></td>
                <td><%= order.createdOn %></td>
                <td><%= order.status %></td>
                <td>
                    <!-- Actions -->
                    <button class="btn btn-primary btn-sm" onclick="location.href='/admin/order/edit/<%= order._id %>'">
                        <i class="bi bi-pencil-square"></i> Edit
                    </button>
                    <button class="btn btn-danger btn-sm" onclick="location.href='/admin/order/delete/<%= order._id %>'">
                        <i class="bi bi-trash-fill"></i> Cancel
                    </button>
                    <button class="btn btn-info btn-sm" onclick="location.href='/admin/order/view/<%= order._id %>'">
                        <i class="bi bi-eye"></i> View
                    </button>
                    <button class="btn btn-success btn-sm" onclick="location.href='/admin/order/block/<%= order._id %>'">
                        <i class="bi bi-lock-fill"></i> Change Status
                    </button>
                   
                </td>
            </tr>
        <% }); %>
    </tbody>
</table>

<!-- Pagination Controls -->
<nav>
    <ul class="pagination justify-content-center" id="paginationControls">
        <% for (let i = 1; i <= totalPages; i++) { %>
            <li class="page-item <%= (i === currentPage) ? 'active' : '' %>">
                <a class="page-link" href="?page=<%= i %>&search=<%= encodeURIComponent(searchTerm) %>"><%= i %></a>
            </li>
        <% } %>
    </ul>
</nav>

<script src="/js/adminJs/orders.js"></script>
<%- include("../../views/partials/admin/footer") %>